#!/usr/bin/env bash

# Set up the core and all dependent packages; their NPM dependencies and HTML
# assets.

set -e

[ -f "./package.json" ] && grep '"name": "megadoc"' ./package.json &> /dev/null || {
  echo "$0: Must be run from megadoc root.";
  exit 1
}

npm install --ignore-scripts

./node_modules/.bin/lerna bootstrap
CONCURRENCY=3 ./bin/lerna-run -O build
